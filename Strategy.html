<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <title>策略模式</title>
</head>

<body>
    <div>
        单例模式的定义是：定义一系列的算法，把它们一个个封装起来，并且使它们可以相互替换
        一个基于策略模式的程序至少由两部分组成。第一个部分是一组策略类，策略类封装了具体
        的算法，并负责具体的计算过程。第二个部分是环境类 Context，Context 接受客户的请求，随后
        把请求委托给某一个策略类。要做到这点，说明 Context 中要维持对某个策略对象的引用。
    </div>
    <script>
        /*
         *
        很多公司的年终奖是根据员工的工资基数和年底绩效情况来发放的。例如，绩效为 S 的人年
        终奖有 4 倍工资，绩效为 A 的人年终奖有 3 倍工资，而绩效为 B 的人年终奖是 2 倍工资。假设财
        务部要求我们提供一段代码，来方便他们计算员工的年终奖。
         *
         */
        /**
        *面向对象的形式
        */
        // 计算类
        var performanceS = function () { };
        performanceS.prototype.calculate = function (salary) {
            return salary * 4;
        };
        var performanceA = function () { };
        performanceA.prototype.calculate = function (salary) {
            return salary * 3;
        };
        var performanceB = function () { };
        performanceB.prototype.calculate = function (salary) {
            return salary * 2;
        };

        var Bonus = function () {
            this.salary = null; // 原始工资
            this.strategy = null; // 绩效等级对应的策略对象
        };
        Bonus.prototype.setSalary = function (salary) {
            this.salary = salary; // 设置员工的原始工资
        };
        Bonus.prototype.setStrategy = function (strategy) {
            this.strategy = strategy; // 设置员工绩效等级对应的策略对象
        };
        Bonus.prototype.getBonus = function () { // 取得奖金数额
            return this.strategy.calculate(this.salary); // 把计算奖金的操作委托给对应的策略对象
        };
        var bonus = new Bonus();
        bonus.setSalary(10000);
        bonus.setStrategy(new performanceS()); // 设置策略对象
        console.log(bonus.getBonus()); // 输出：40000 
        bonus.setStrategy(new performanceA()); // 设置策略对象
        console.log(bonus.getBonus()); // 输出：30000


        /**
        *javascript形式
        */
        var strategies = {
            "S": function (salary) {
                return salary * 4;
            },
            "A": function (salary) {
                return salary * 3;
            },
            "B": function (salary) {
                return salary * 2;
            }
        };

        var calculateBonus = function (level, salary) {
            return strategies[level](salary);
        };
        console.log(calculateBonus('S', 20000)); // 输出：80000 
        console.log(calculateBonus('A', 10000)); // 输出：30000
    </script>
</body>

</html>